<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cn" lang="cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Zip 编码类 - CodeIgniter 中文手册</title>
<link rel="stylesheet" type="text/css" media="all" href="../userguide.css" />
<link rel="search" href="http://codeigniter.org.cn/CodeIgniterSearch.xml" type="application/opensearchdescription+xml" title="CodeIgniter 搜索"/>
<script type="text/javascript" src="../nav/nav.js"></script>
<script type="text/javascript" src="../nav/prototype.lite.js"></script>
<script type="text/javascript" src="../nav/moo.fx.js"></script>
<script type="text/javascript" src="../nav/user_guide_menu.js"></script>
<meta name="robots" content="all" />
<meta name="author" content="ExpressionEngine Dev Team" />
<meta name="description" content="CodeIgniter 中文手册, CodeIgniter 用户指南, CodeIgniter User Guide, Wiki 文档" />
</head>
<body>
<!-- START NAVIGATION -->
<div id="nav">
  <div id="nav_inner">
    <script type="text/javascript">create_menu('../');</script>
  </div>
</div>
<div id="nav2"><a name="top"></a><a href="javascript:void(0);" onclick="myHeight.toggle();"><img src="../images/nav_toggle.jpg" width="153" height="44" border="0" title="切换目录" alt="切换目录" /></a></div>
<div id="masthead">
  <table cellpadding="0" cellspacing="0" border="0" style="width:100%">
    <tr>
      <td width="350"><h1>CodeIgniter 用户指南 版本 1.6.3</h1></td>
      <td id="breadcrumb_right"><a href="../toc.html">目录页</a></td>
    </tr>
  </table>
</div>
<!-- END NAVIGATION -->
<!-- START BREADCRUMB -->
<table cellpadding="0" cellspacing="0" border="0" style="width:100%">
  <tr>
    <td id="breadcrumb">
		<a href="http://codeigniter.org.cn/" target="_blank">CodeIgniter 中国首页</a>&nbsp;&#8250;&nbsp;
<a href="../index.html">用户指南首页</a>&nbsp;&#8250;&nbsp;<a href="index.html">类库</a>&nbsp;&#8250;&nbsp;Zip 编码类	</td>
    <td id="searchbox">
		<form method="get" action="http://www.google.com/search" target="google_window">
		<input type="hidden" name="client" value="pub-0176846097796333"></input>
		<input type="hidden" name="forid" value="1"></input>
		<input type="hidden" name="ie" value="UTF-8"></input>
		<input type="hidden" name="oe" value="UTF-8"></input>
        <input type="hidden" name="as_sitesearch" id="as_sitesearch" value="codeigniter.org.cn/user_guide/" />
        搜索用户指南&nbsp;
        <input type="text" class="input" style="width:200px;" name="q" id="q" size="31" maxlength="255" value="" />
        &nbsp;
        <input type="submit" class="submit" name="sa" value="Go" />
      </form>
	</td>
  </tr>
</table>
<!-- END BREADCRUMB -->
<!--<br clear="all" />-->
<!-- START CONTENT -->
<div id="content">
<h1>Zip 编码类</h1>

<p>CodeIgniter的zip编码类允许你创建ZIP压缩文档。文档可以保存在你的桌面或者某个文件夹里</p>


<h2>初始化</h2>
<p>与其他CodeIgniter里的类一样，ZIP类在控制器里完成初始化工作，函数：<dfn>$this-&gt;load-&gt;library</dfn></p>
<code>$this-&gt;load-&gt;library('zip');</code>
<p>一旦加载，ZIP库对象可以用<dfn>$this-&gt;zip</dfn>来使用</p>

<h2>使用样例</h2>

<p>这个例子演示了如何压缩一个文件并保存到你服务器一个文件夹，然后下载到你的桌面上。</p>
<code>
$name = 'mydata1.txt';<br />

$data = 'A Data String!';<br />
<br />
$this-&gt;zip-&gt;add_data($name, $data);<br />
<br />
// 在你的服务器的文件夹里写.zip文件。命名为"my_backup.zip"<br />
$this-&gt;zip-&gt;archive('/path/to/directory/my_backup.zip');
<br /><br />
 // 下载此文件到桌面，命名为"my_backup.zip"<br />
$this-&gt;zip-&gt;download('my_backup.zip');
</code>

<h1>函数参考</h1>

<h2>$this-&gt;zip-&gt;add_data()</h2>

<p>添加数据进zip文件里. 第一个参数是文件名, 第二个参数是你要添加的数据的字符串格式:</p>

<code>
$name = 'my_bio.txt';<br />
$data = 'I was born in an elevator...';<br />
<br />
$this-&gt;zip-&gt;add_data($name, $data);
</code>

<p>允许你多次调用这个函数按顺序的添加若干个文件到你的存档。例子：</p>

<code>
$name = 'mydata1.txt';<br />
$data = 'A Data String!';<br />
$this-&gt;zip-&gt;add_data($name, $data);<br />
<br />
$name = 'mydata2.txt';<br />
$data = 'Another Data String!';<br />
$this-&gt;zip-&gt;add_data($name, $data);<br />
</code>

<p>或者你可以使用一个数组来传递多个文件（的值）：</p>

<code>
$data = array(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'mydata1.txt' => 'A Data String!',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'mydata2.txt' => 'Another Data String!'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />
<br />
$this-&gt;zip-&gt;add_data($data);<br />
<br />
$this-&gt;zip-&gt;download('my_backup.zip');

</code>

<p>If you would like your compressed data organized into sub-folders, include the path as part of the filename:</p>

<code>
$name = '<kbd>personal/</kbd>my_bio.txt';<br />
$data = 'I was born in an elevator...';<br />
<br />
$this-&gt;zip-&gt;add_data($name, $data);
</code>

<p>上面的例子将放置 <dfn>my_bio.txt</dfn> 到一个叫<kbd>personal</kbd>的文件夹内。</p>


<h2>$this-&gt;zip-&gt;add_dir()</h2>

<p>允许你添加一个目录。通常这个函数是不必要的，因为当你使用<dfn>$this-&gt;zip-&gt;add_data()</dfn>, 可以把你的数据放进目录里，但是如果你想要创建一个空目录的话你也可以这样做。例子：</p>

<code>$this-&gt;zip-&gt;add_dir('myfolder'); // Creates a folder called "myfolder"</code>



<h2>$this-&gt;zip-&gt;read_file&#40;&#41;</h2>

<p>允许你压缩一个服务器某处存在的文件。提供一个文件路径，zip类将读取它并添加到存档：</p>

<code>
$path = '/path/to/photo.jpg';<br /><br />
$this-&gt;zip-&gt;read_file&#40;$path&#41;;
<br /><br />
 // Download the file to your desktop.  Name it "my_backup.zip"<br />
$this-&gt;zip-&gt;download('my_backup.zip');
</code>

<p>如果你想压缩文档保持原来文件的目录结构，可以价格第二个参数设置为 <kbd>TRUE</kbd> （布尔值）。例子：</p>


<code>
$path = '/path/to/photo.jpg';<br /><br />
$this-&gt;zip-&gt;read_file&#40;$path, <kbd>TRUE</kbd>&#41;;
<br /><br />
 // Download the file to your desktop.  Name it "my_backup.zip"<br />
$this-&gt;zip-&gt;download('my_backup.zip');
</code>

<p>在上边的例子中，<dfn>photo.jpg</dfn>将被放到两层文件夹中：<kbd>path/to/</kbd> </p>



<h2>$this-&gt;zip-&gt;read_dir()</h2>

<p>允许你压缩一个服务器某处存在的文件夹（以及它里面的文件和子文件夹）。提供一个文件夹路径，zip类将递归读取它并重新创建添加到存档。 All files contained within the
supplied path will be encoded, as will any sub-folders contained within it.  Example:</p>

<code>
$path = '/path/to/your/directory/';<br /><br />
$this-&gt;zip-&gt;read_dir($path);
<br /><br />
 // Download the file to your desktop.  Name it "my_backup.zip"<br />

$this-&gt;zip-&gt;download('my_backup.zip');
</code>




<h2>$this-&gt;zip-&gt;archive()</h2>

<p>Writes the Zip-encoded file to a directory on your server.  Submit a valid server path ending in the file name.  Make sure the
directory is writable (666 or 777 is usually OK). Example:</p>

<code>$this-&gt;zip-&gt;archive('/path/to/folder/myarchive.zip'); // Creates a file named myarchive.zip</code>


<h2>$this-&gt;zip-&gt;download()</h2>

<p>Causes the Zip file to be downloaded from your server. The function must be passed the name you would like the zip file called.
Example:</p>

<code>$this-&gt;zip-&gt;download('latest_stuff.zip'); // File will be named "latest_stuff.zip"</code>

<p class="important"><strong>Note:</strong>&nbsp; Do not display any data in the controller in which you call this function since it sends various server headers
that cause the download to happen and the file to be treated as binary.</p>


<h2>$this-&gt;zip-&gt;get_zip()</h2>

<p>Returns the Zip-compressed file data.  Generally you will not need this function unless you want to do something unique with the data.
Example:</p>

<code>
$name = 'my_bio.txt';<br />
$data = 'I was born in an elevator...';<br />
<br />
$this-&gt;zip-&gt;add_data($name, $data);<br /><br />

$zip_file = $this-&gt;zip-&gt;get_zip();
</code>


<h2>$this-&gt;zip-&gt;clear_data()</h2>

<p>The Zip class caches your zip data so that it doesn't need to recompile the Zip archive for each function you use above.
If, however, you need to create multiple Zips, each with different data, you can clear the cache between calls. Example:</p>

<code>
$name = 'my_bio.txt';<br />
$data = 'I was born in an elevator...';<br />
<br />
$this-&gt;zip-&gt;add_data($name, $data);<br />
$zip_file = $this-&gt;zip-&gt;get_zip();<br />
<br />
<kbd>$this-&gt;zip-&gt;clear_data();</kbd>
<br /><br />

$name = 'photo.jpg';<br />
$this-&gt;zip-&gt;read_file&#40;"/path/to/photo.jpg"&#41;; // Read the file's contents<br />
<br /><br />
$this-&gt;zip-&gt;download('myphotos.zip');
</code><p>&nbsp;</p>
<div id="Contributors">
翻译贡献者:
architectcom, Hex, lomatus, skey, yygcom</div>
<div id="DocDate">最后修改: 2008-07-16 10:27:24</div>
</div>
<!-- END CONTENT -->
<div id="footer">
  <p>
上一个主题:&nbsp;&nbsp;<a href="../libraries/xmlrpc.html">XML-RPC 类</a>&nbsp;&nbsp;&middot;&nbsp;&nbsp;<a href="#top">页首</a>
&nbsp;&middot;&nbsp;&nbsp;<a href="../index.html">用户指南首页</a>&nbsp;&nbsp;&middot;&nbsp;&nbsp;下一个主题:&nbsp;&nbsp;<a href="../helpers/array_helper.html">数组辅助函数</a>  </p>
  <p><a href="http://codeigniter.com" target="_blank">CodeIgniter</a> &nbsp;&middot;&nbsp; 版权所有 &#169; 2006-2008 &nbsp;&middot;&nbsp; <a href="http://ellislab.com/" target="_blank">Ellislab, Inc.</a></p>
  <p>中文化: <a href="http://codeigniter.org.cn" target="_blank">CodeIgniter 中国</a> &nbsp;&middot;&nbsp; 制作: Hex &nbsp;&middot;&nbsp; 生成日期: 2008-09-22 01:15</p>
</div>
</body>
</html>